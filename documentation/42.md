# Часть 42. Изменение размера изображений товаров в реальном времени с помощью Intervention
В этой части серии обучающих программ по электронной коммерции на Laravel 12 от нескольких поставщиков мы реализуем изменение размера изображений товаров в реальном времени с помощью Intervention Image v3.

Вместо хранения нескольких версий одного и того же изображения теперь мы динамически изменяем размер изображений, используя подход на основе URL.

Это помогает:
- Экономия места
- Централизуйте определения размеров
- Улучшение ремонтопригодности
## Шаг 1. Маршрут для динамического изменения размера изображения
Мы добавили следующий маршрут для динамической генерации и обслуживания сжатых изображений с использованием названий размеров, таких как «миниатюра», «маленький», «средний», «большой».
```php
// web.php
Route::get('product-image/{size}/{filename}', function ($size, $filename) {
    $sizes = config('image_sizes.product');
    if (!isset($sizes[$size])) {
        abort(404, 'Invalid size.');
    }
    $width = $sizes[$size]['width'];
    $height = $sizes[$size]['height'];
    $path = public_path('front/images/products/' . $filename);
    if (!file_exists($path)) {
        abort(404, 'Image not found.');
    }
    $image = Image::read($path)->scale($width, $height);
    return response()->image($image, Format::JPEG, 85);
});
```
## Шаг 2. Централизованные размеры изображений в файле конфигурации
Мы определяем фиксированные размеры для миниатюр, малых, средних и больших размеров в специальном файле конфигурации:

**config/image_sizes.php**
```php
return [
    'product' => [
        'thumbnail' => ['width' => 50, 'height' => 65],
        'small' => ['width' => 150, 'height' => 200],
        'medium' => ['width' => 300, 'height' => 400],
        'large' => ['width' => 600, 'height' => 800],
    ],
];
```
## Шаг 3. Обновленные представления Blade для изображений продуктов
Теперь все предварительные просмотры изображений продуктов используют динамически изменяемые изображения по URL-адресу:
```html
{{-- Product Main Image --}}
@if(!empty($product['main_image']))
    <a target="_blank" href="{{ url('front/images/products/' . $product['main_image']) }}"><img style="margin: 10px" src="{{ asset('/product-image/thumbnail/' . $product['main_image']) }}" alt="{{ $product['product_name'] }}"></a>
    <a style="color: #3f6ed3" class="confirmDelete"
       title="Delete Product Image" href="javascript:void(0)"
       data-module="product-main-image" data-id="{{ $product['id'] }}"><i class="fas fa-trash"></i></a>
@endif

{{-- Product Alternate Images --}}
@foreach($product->product_images as $img)
    <div class="sortable-item" data-id="{{ $img->id }}" style="position: relative;">
        <a target="_blank"
           href="{{ url('front/images/products/' . $img->image) }}">
            <img src="{{ asset('product-image/thumbnail/' . $img->image) }}" alt="">
        </a>
        <a href="javascript:void(0)" class="confirmDelete"
           data-module="product-image" data-id="{{ $img->id }}"
           data-image="{{ $img->image }}">
            <i class="fas fa-trash"
               style="position: absolute; top: 0; right: 0; color: red;"></i>
        </a>
    </div>
@endforeach
```
Преимущества:
- Нет необходимости загружать изображения разных размеров.
- Легко меняйте размеры из одного места.
- Сжатие и изменение размера в реальном времени.
- Чистый и поддерживаемый Blade-код.

Совет: вы можете повторно использовать этот метод для баннеров, категорий, логотипов и многого другого, расширив конфигурацию и скорректировав маршруты!
# Что дальше?
В [следующей части](43.md) мы добавим в панель администратора расширенную функцию, которая позволит каждому администратору настраивать и сохранять порядок столбцов DataTables (категории и продукты) с помощью ColReorder, AJAX и внутренней логики Laravel.

[Оглавление](../README.md)
