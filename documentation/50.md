# Часть 50. Обновление панели администратора | Вставка продуктов с помощью Seeder
В этой части мы внесем важные улучшения в бэкэнд:
- Обновите панель администратора, чтобы динамически отображать количество модулей в реальном времени.
- Удалите нежелательный устаревший код из пользовательского интерфейса панели управления.
- Создайте ProductsTableSeeder для вставки записей о товарах с использованием Laravel Seeder.
- Используйте команду **php artisan migrate:fresh --seed** для быстрого сброса и заполнения всей базы данных тестовыми данными.
## Шаг 1. Обновите файл dashboard.blade.php:
Очистите старый вид панели инструментов, удалив ненужный HTML-код:
```html
<!--begin::Row-->
<div class="row">
    <!-- удалите весь этот код -->
</div>
<!-- /.row (main row) -->
```
## Шаг 2. Обновите функцию index() в AdminController:
Получите количество различных модулей, таких как категории, продукты, бренды и пользователи:
```php
public function index()
    {
        Session::put('page', 'dashboard');
        $categoriesCount = Category::get()->count();
        $productsCount = Product::get()->count();
        $brandsCount = Brand::get()->count();
        $usersCount = User::get()->count();
        $couponsCount = 0;
        $ordersCount = 0;
        $pagesCount = 0;
        $enquiriesCount = 0;
        return view('admin.dashboard')->with(compact(
            'categoriesCount',
            'productsCount',
            'brandsCount',
            'usersCount',
            'couponsCount',
            'ordersCount',
            'pagesCount',
            'enquiriesCount'
        ));
    }
```
## Шаг 3. Отображение количества модулей на панели инструментов:
Обновите HTML-код в представлении dashboard.blade.php, чтобы отобразить динамические данные с использованием переданных нами переменных (**$categoriesCount**, **$productsCount** и т.д.).
```html
<div class="app-content">
    <!--begin::Container-->
    <div class="container-fluid">
        <!--begin::Row-->
        <div class="row">
            <!--begin::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 1-->
                <div class="small-box text-bg-primary">
                    <div class="inner">
                        <h3>{{ $categoriesCount }}</h3>
                        <p>Категорий</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M10 3H4a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1V4a1 1 0 00-1-1zM9 9H5V5h4v4zm11-6h-6a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1V4a1 1 0 00-1-1zm-1 6h-4V5h4v4zm-9 4H4a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1v-6a1 1 0 00-1-1zm-1 6H5v-4h4v4zm8-6c-2.206 0-4 1.794-4 4s1.794 4 4 4 4-1.794 4-4-1.794-4-4-4zm0 6c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2z" fill="currentColor" />
                    </svg>
                    <a href="{{ route('categories.index') }}"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 1-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 2-->
                <div class="small-box text-bg-success">
                    <div class="inner">
                        <h3>{{ $productsCount }}</h3>
                        <p>Товаров</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true" >
                        <path d="M7 5h10a2 2 0 012 2v10a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2zm0 1a1 1 0 00-1 1v10a1 1 0 001 1h10a1 1 0 001-1V7a1 1 0 00-1-1H7zm1 2h8a1 1 0 011 1v8a1 1 0 01-1 1H8a1 1 0 01-1-1V9a1 1 0 011-1z" fill="currentColor"/>
                    </svg>
                    <a href="{{ route('products.index') }}"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 2-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 3-->
                <div class="small-box text-bg-warning">
                    <div class="inner">
                        <h3>{{ $brandsCount }}</h3>
                        <p>Брендов</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8zm-5-8h10v2H7z" fill="currentColor" />
                    </svg>
                    <a href="{{ route('brands.index') }}"
                       class="small-box-footer link-dark link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации  <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 3-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 4-->
                <div class="small-box text-bg-danger">
                    <div class="inner">
                        <h3>{{ $usersCount }}</h3>
                        <p>Пользователей</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm0 12.2c-2.538 0-4.93-1.119-6.541-3.085C5.47 13.701 8.057 13 12 13c3.943 0 6.531.701 7.541 3.115-1.612 1.966-4.004 3.085-6.541 3.085z" fill="currentColor" />
                    </svg>
                    <a href="{{ url('admin/subadmins') }}"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 4-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 5-->
                <div class="small-box text-bg-info">
                    <div class="inner">
                        <h3>{{ $couponsCount }}</h3>
                        <p>Купонов</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M21 5H3a1 1 0 00-1 1v4h.893c.996 0 1.92.681 2.08 1.664A2.001 2.001 0 013 12H2v4a1 1 0 001 1h18a1 1 0 001-1v-4h-1a2.001 2.001 0 01-1.973-2.336c.16-.983 1.084-1.664 2.08-1.664H22V6a1 1 0 00-1-1zM4 8.5a.5.5 0 11-1 0 .5.5 0 011 0zm1.5 5.5a.5.5 0 110-1 .5.5 0 010 1z" fill="currentColor" />
                    </svg>
                    <a href="#"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 5-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 6-->
                <div class="small-box text-bg-secondary">
                    <div class="inner">
                        <h3>{{ $ordersCount }}</h3>
                        <p>Заказов</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M20 4H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm0 2v.51l-8 6.223-8-6.222V6h16zM4 18V9.0447.386 5.745.994.994 0 001.228 OL20 9.044 20.002 18H4z" fill="currentColor" />
                    </svg>
                    <a href="#"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 6-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 7-->
                <div class="small-box text-bg-muted">
                    <div class="inner">
                        <h3>{{ $pagesCount }}</h3>
                        <p>Страниц</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M19 2H5a2 2 0 00-2 2v16a2 2 0 002 2h14a2 2 0 002-2V4a2 2 0 00-2-2zm0 18H5V4h14v16zM7 8h10v2H7zm0 4h10v2H7z" fill="currentColor" />
                    </svg>
                    <a href="#"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 7-->
            </div>
            <!--end::Col-->
            <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 8-->
                <div class="small-box text-bg-light">
                    <div class="inner">
                        <h3>{{ $enquiriesCount }}</h3>
                        <p>Запросов</p>
                    </div>
                    <svg class="small-box-icon" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M20 4H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm0 2v.511l-8 6.223-8-6.222V6h16zM4 18V9.044l7.386 5.745.994.994 0 001.228 OL20 9.044 20.002 18H4z" fill="currentColor" />
                    </svg>
                    <a href="#"
                       class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover">
                        Больше информации <i class="bi bi-link-45deg"></i>
                    </a>
                </div>
                <!--end::Small Box Widget 8-->
            </div>
            <!--end::Col-->
        </div>
        <!--end::Row-->
    </div>
    <!--end::Container-->
</div>
```
## Шаг 4. Создайте ProductsTableSeeder:
Создайте seeder с помощью команды:
```
php artisan make:seeder ProductsTableSeeder
```
Затем отредактируйте файл **database/seeders/ProductsTableSeeder.php** следующим образом:
```php
namespace Database\Seeders;

use App\Models\Category;
use App\Models\Product;
use Carbon\Carbon;
use Illuminate\Database\Seeder;

class ProductsTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $menTShirtsCategory = Category::where('name', 'Мужские футболки')->first();
        if ($menTShirtsCategory) {
            Product::create([
                'category_id' => $menTShirtsCategory->id,
                'brand_id' => 1,
                'admin_id' => 1,
                'admin_role' => 'admin',
                'product_name' => 'Синяя футболка',
                'product_code' => 'BCT001',
                'product_color' => 'Темно синий',
                'family_color' => 'Синий',
                'group_code' => 'BCT000',
                'product_price' => 1000,
                'product_discount' => 10,
                'product_discount_amount' => 100,
                'product_applied_on' => 'product',
                'product_gst' => 12,
                'final_price' => 900,
                'main_image' => '',
                'product_weight' => 500,
                'product_video' => '',
                'description' => 'Тестовый продукт',
                'wash_care' => '',
                'search_keywords' => '',
                'fabric' => '',
                'pattern' => '',
                'sleeve' => '',
                'fit' => '',
                'occasion' => '',
                'stock' => 10,
                'sort' => 1,
                'meta_title' => '',
                'meta_description' => '',
                'meta_keywords' => '',
                'is_featured' => 'No',
                'status' => 1,
                'created_at' => Carbon::now(),
                'updated_at' => Carbon::now(),
            ]);
            Product::create([
                'category_id' => $menTShirtsCategory->id,
                'brand_id' => 1,
                'admin_id' => 1,
                'admin_role' => 'admin',
                'product_name' => 'Красная футболка',
                'product_code' => 'RCT001',
                'product_color' => 'Красный',
                'family_color' => 'Красный',
                'group_code' => 'BT000',
                'product_price' => 2000,
                'product_discount' => 0,
                'product_discount_amount' => 0,
                'product_applied_on' => '',
                'product_gst' => 12,
                'final_price' => 2000,
                'main_image' => '',
                'product_weight' => 400,
                'product_video' => '',
                'description' => 'Тестовый продукт',
                'wash_care' => '',
                'search_keywords' => '',
                'fabric' => '',
                'pattern' => '',
                'sleeve' => '',
                'fit' => '',
                'occasion' => '',
                'stock' => 10,
                'sort' => 2,
                'meta_title' => '',
                'meta_description' => '',
                'meta_keywords' => '',
                'is_featured' => 'Yes',
                'status' => 1,
                'created_at' => Carbon::now(),
                'updated_at' => Carbon::now(),
            ]);
        }
    }
}
```
## Шаг 5. Обновите DatabaseSeeder.php:
Добавьте новый класс **seeder** в метод **run**:
```php
public function run(): void
{
    $this->call(AdminsTableSeeder::class);
    $this->call(CategoryTableSeeder::class);
    $this->call(BrandTableSeeder::class);
    $this->call(ColorTableSeeder::class);
    $this->call(ProductsTableSeeder::class);
    $this->call(ProductsAttributesTableSeeder::class);
}
```
## Шаг 6. Обновите ProductsAttributesTableSeeder:
Убедитесь, что файл **TableSeeder.php** атрибутов продуктов выглядит следующим образом:
```php
public function run(): void
{
    $productAttributesRecords = [
        [
            'product_id' => 1,
            'sku' => 'BCT001-S',
            'size' => 'Small',
            'price' => 1000,
            'stock' => 10,
            'sort' => 1,
            'status' => 1,
        ],
        [
            'product_id' => 1,
            'sku' => 'BCT001-M',
            'size' => 'Medium',
            'price' => 1100,
            'stock' => 20,
            'sort' => 2,
            'status' => 1,
        ],
        [
            'product_id' => 1,
            'sku' => 'BCT001-L',
            'size' => 'Large',
            'price' => 1200,
            'stock' => 10,
            'sort' => 3,
            'status' => 1,
        ],
    ];
    ProductsAttribute::insert($productAttributesRecords);
}
```
## Шаг 7. Обновите BrandTableSeeder:
Убедитесь, что **BrandTableSeeder.php** выглядит следующим образом:
```php
class BrandTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $brands = [
                ['name' => 'Arrow', 'url' => 'arrow'],
                ['name' => 'Gar', 'url' => 'gap'],
                ['name' => 'Lee', 'url' => 'lee'],
                ['name' => 'Monte Carlo', 'url' => 'monte-carlo'],
                ['name' => 'Peter England', 'url' => 'peter-england'],
            ];
            foreach ($brands as $data) {
                Brand::create([
                    'name' => $data['name'],
                    'image' => '',
                    'logo' => '',
                    'discount' => 0,
                    'description' => '',
                    'url' => $data['url'],
                    'meta_title' => '',
                    'meta_description' => '',
                    'meta_keywords' => '',
                    'status' => 1,
                    'created_at' => Carbon::now(),
                    'updated_at' => Carbon::now(),
                ]);
        }
    }
}
```
## Шаг 8. Запуск команды «Миграция + посев»:
Наконец, сбросьте и заполните базу данных с помощью: 
```
php artisan migrate:fresh --seed
```
Благодаря этому ваша панель администратора становится более информативной благодаря подсчетам в реальном времени, а база данных предварительно загружается необходимыми данными с помощью seeders, что делает разработку более плавной и быстрой.
# Что дальше?
В [следующей части](51.md) мы начнем работать над интерфейсом нашего сайта электронной коммерции, а также продолжим усовершенствование панели администратора.

[Оглавление](../README.md)
