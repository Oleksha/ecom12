# Часть 39. Атрибуты продукта (III) | Активировать/Деактивировать/Удалить атрибуты
В этой части мы реализуем функции активации/деактивации и удаления для атрибутов продукта.
# Активировать/Деактивировать атрибут
## Шаг 1. Обновление add_edit_product.blade.php Просмотр
Мы изменим blade-файл, включив в него значки переключения «Активно/Неактивно» и «Удалить» для каждого атрибута продукта:
```html
<td>
    @if($attribute['status'] == 1)
        <a class="updateAttributeStatus text-primary me-2"
           id="attribute-{{ $attribute['id'] }}"
           data-attribute-id="{{ $attribute['id'] }}"
           href="javascript:void(0)">
            <i class="fa fa-toggle-on" data-status="Active"></i>
        </a>
    @else
        <a class="updateAttributeStatus text-secondary me-2"
           id="attribute-{{ $attribute['id'] }}"
           data-attribute-id="{{ $attribute['id'] }}"
           href="javascript:void(0)">
            <i class="fa fa-toggle-off" data-status="Inactive"></i>
        </a>
    @endif
    <a title="Delete Attribute" href="javascript:void(0)"
       class="confirmDelete text-danger" data-module="product-attribute"
       data-id="{{ $attribute['id'] }}">
        <i class="fa fa-trash"></i>
    </a>
</td>
```
## Шаг 2. Обновите файл custom.js.
Мы добавим функцию jQuery для обработки обновлений статуса атрибутов через AJAX:
```js
// Update Product Status
$(document).on("click", ".updateAttributeStatus", function(){
    let status = $(this).children('i').data('status');
    let attribute_id = $(this).data('attribute-id');
    $.ajax({
        headers: {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: "/admin/update-attribute-status",
        data: { status: status, attribute_id: attribute_id},
        success: function (response) {
            if (response['status'] === 0) {
                $("a[data-attribute-id='" + attribute_id + "']").html("<i class='fa fa-toggle-off' style='color: gray' data-status='Inctive'></i>");
            } else if (response['status'] === 1) {
                $("a[data-attribute-id='" + attribute_id + "']").html("<i class='fa fa-toggle-on' style='color: #3f6ed3' data-status='Active'></i>");
            }
        },
        error: function () {
            alert("Error");
        }
    });
});
```
## Шаг 3. Создать маршрут в web.php
Определите маршрут POST для обновления статуса атрибута:
```php
Route::post('update-attribute-status', [ProductController::class, 'updateAttributeStatus']);
```
## Шаг 4. Метод контроллера в ProductController: updateAttributeStatus()
Этот метод перехватывает AJAX-запрос и делегирует логику ProductService. 
Он возвращает обновлённый статус в формате JSON.
```php
public function updateAttributeStatus(Request $request)
{
    if ($request->ajax()) {
        $data = $request->all();
        $status = $this->productService->updateAttributeStatus($data);
        return response()->json(['status' => $status, 'attribute_id' => $data['attribute_id']]);
    }
}
```
## Шаг 5. Метод службы в ProductService: updateAttributeStatus()
Этот метод службы содержит фактическую логику для переключения статуса атрибута в базе данных (Активный <=> Неактивный).
```php
public function updateAttributeStatus(array $data): int
{
    $status =($data['status'] == "Active") ? 0 : 1;
    ProductsAttribute::where('id', $data['attribute_id'])->update(['status' => $status]);
    return $status;
}
```
Благодаря этому теперь вы можете переключать статус «Активно»/«Неактивно» любого атрибута продукта.
# Удалить атрибут
## Шаг 6. Создание маршрута удаления в web.php
Мы добавляем маршрут GET, который указывает на метод контроллера, отвечающий за удаление определенного атрибута продукта по его идентификатору.
```php
Route::get('delete-product-attribute/{id}', [ProductController::class, 'deleteProductAttribute']);
```
## Шаг 7. Метод контроллера в ProductController: deleteProductAttribute()
Этот метод вызывает службу для удаления атрибута продукта, а затем перенаправляет обратно с сообщением об успешном завершении.
```php
public function deleteProductAttribute(string $id)
{
    $message = $this->productService->deleteProductAttribute($id);
    return redirect()->back()->with('success_message', $message);
}
```
## Шаг 8. Метод службы в ProductService: deleteProductAttribute()
Это основная логика удаления атрибута из базы данных с использованием его идентификатора.
```php
public function deleteProductAttribute(string $id): string
{
    // Delete Attribute
    ProductsAttribute::where('id', $id)->delete();
    return 'Product Attribute has been deleted successfully!';
}
```
Теперь вы можете успешно удалить любой атрибут продукта с подтверждением и сообщением об успешном завершении операции.
# Что дальше?
В [следующей части](39.md) мы реализуем сортировку изображений товаров, определив, какие изображения должны отображаться и в каком порядке.

[Оглавление](../README.md)
