# Часть 10. Смена пароля администратора
В этой части мы создадим форму «Обновить пароль», которая позволит администратору безопасно обновлять свой пароль через панель администратора. Мы займёмся отображением формы, настройкой маршрута и обновлением навигации на боковой панели с учётом новой опции в разделе «Управление администратором».

В этой части мы сосредоточимся на создании формы и интеграции с UL. В следующей части мы займёмся обновлением и проверкой пароля.
## Шаг 1. Создать маршрут
Создайте маршрут GET для отображения формы обновления пароля в web.php:
```php
Route::group(['middleware' => ['admin']], function () {
    // Display Update Password Page
    Route::get('update-password', [AdminController::class, 'edit'])
        ->name('admin.update-password');
});
```
## Шаг 2. Обновите функцию edit() в AdminController
Создайте функцию edit() для возврата представления обновления пароля:
```php
public function edit(Admin $admin)
{
    return view('admin.update-password');
}
```
## Шаг 3. Создайте update_password.blade.php
Создайте новый файл представления, аналогичный dashboard.blade.php, и добавьте поля формы для:
- Электронная почта (только для чтения)
- Текущий пароль
- Новый пароль
- Подтвердите пароль

Используйте шаблон AdminLTE для разработки формы:
- Скопируйте содержимое формы из шаблона AdminLTE, расположенного по адресу:
```
/dist/pages/forms/general.html
```
- Скопируйте основное содержимое с классом app-main и обновите его следующим образом:
```html
<main class="app-main">
    <!--begin::App Content Header-->
    <div class="app-content-header">
        <!--begin::Container-->
        <div class="container-fluid">
            <!--begin::Row-->
            <div class="row">
                <div class="col-sm-6"><h3 class="mb-0">Управление администратором</h3></div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-end">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Update Password</li>
                    </ol>
                </div>
            </div>
            <!--end::Row-->
        </div>
        <!--end::Container-->
    </div>
    <!--end::App Content Header-->
    <!--begin::App Content-->
    <div class="app-content">
        <!--begin::Container-->
        <div class="container-fluid">
            <!--begin::Row-->
            <div class="row g-4">
                <!--begin::Col-->
                <div class="col-md-6">
                    <!--begin::Quick Example-->
                    <div class="card card-primary card-outline mb-4">
                        <!--begin::Header-->
                        <div class="card-header"><div class="card-title">Update Password</div></div>
                        <!--end::Header-->
                        <!--begin::Form-->
                        <form method="post" action="#">@csrf
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email address</label>
                                    <input type="email" class="form-control" id="email"
                                        aria-describedby="emailHelp" value="{{ Auth::guard('admin')->user()->email }}" readonly style="background-color: #cccccc;">
                                    <div id="emailHelp" class="form-text">
                                        We'll never share your email with anyone else.
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="current_pwd" class="form-label">Current Password</label>
                                    <input type="password" class="form-control" id="current_pwd" name="current_pwd">
                                    <span id="verifyPwd"></span>
                                </div>
                                <div class="mb-3">
                                    <label for="new_pwd" class="form-label">New Password</label>
                                    <input type="password" class="form-control" id="new_pwd" name="new_pwd">
                                </div>
                                <div class="mb-3">
                                    <label for="confirm_pwd" class="form-label">Confirm Password</label>
                                    <input type="password" class="form-control" id="confirm_pwd" name="confirm_pwd">
                                </div>
                            </div>
                            <!--end::Body-->
                            <!--begin::Footer-->
                            <div class="card-footer">
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                            <!--end::Footer-->
                        </form>
                        <!--end::Form-->
                    </div>
                    <!--end::Quick Example-->
                </div>
                <!--end::Col-->
            </div>
            <!--end::Row-->
        </div>
        <!--end::Container-->
    </div>
    <!--end::App Content-->
</main>
```
## Шаг 4. Включить модель администратора и сеанс
Обязательно включите модель Admin и сеанс в верхнюю часть AdminController:
```php
use App\Models\Admin;
use Illuminate\Support\Facades\Session;
```
## Шаг 5. Обновить функцию edit()
Обновите функцию edit(), чтобы задать сеанса для страницы обновления пароля:
```php
public function edit(Admin $admin)
{
    Session::put('page', 'update-password');
    return view('admin.update-password');
}
```
## Шаг 6. Обновить функцию index()
Обновите функцию index() в AdminController, чтобы задать значение сеанса для подсветки ссылки на панель управления:
```php
public function index()
{
    Session::put('page', 'dashboard');
    return view('admin.dashboard');
}
```
## Шаг 7. Обновите навигацию боковой панели
Обновите sidebar.blade.php, чтобы отобразить раздел «Управление администратором» и выделить активные ссылки с использованием значений сеанса:
```html
<li class="nav-item menu-open">
    <a href="#" class="nav-link active">
        <i class="nav-icon bi bi-speedometer"></i>
        <p>
            Admin Management
            <i class="nav-arrow bi bi-chevron-right"></i>
        </p>
    </a>
    <ul class="nav nav-treeview">
        <li class="nav-item">
            <a href="{{ url('admin/dashboard') }}" class="nav-link {{ (Session::get('page') == 'dashboard') ? 'active' : '' }}">
                <i class="nav-icon bi bi-circle"></i>
                <p>Dashboard</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="{{ route('admin.update-password') }}" class="nav-link {{ (Session::get('page') == 'update-password') ? 'active' : '' }}">
                <i class="nav-icon bi bi-circle"></i>
                <p>Update Password</p>
            </a>
        </li>
    </ul>
</li>
```
**Теперь вы можете протестировать!**

Перейдите в раздел «Панель администратора» → «Управление администратором» → «Обновить пароль». Должна появиться форма с заполненными полями адреса электронной почты и пароля, готовыми к проверке.
# Что дальше?
В [следующей части](11.md) мы:
- Проверьте текущий пароль с помощью AJAX
- Отображение обратной связи в реальном времени в поле пароля
- Безопасное обновление пароля в базе данных

[Оглавление](../README.md)
