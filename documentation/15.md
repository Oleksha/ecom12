# Часть 15. Роли и разрешения (I) | Отображение субадминистраторов в панели администратора
В этой части мы начнем работать над ролями и разрешениями субадминистратора для панели администратора Laravel 12.

Эта функция позволит администратору добавлять субадминистраторов с определенными ролями и разрешениями, обеспечивая лучший контроль доступа к модулям электронной коммерции.

Например, один субадминистратор может управлять ролями пользователей, другой — ролями заказов, или некоторые субадминистраторы могут иметь оба разрешения. Суперадминистратор сохранит полный контроль над всеми ролями и разрешениями.

Что мы рассмотрим в этой части:
- **Добавление субадминистраторов в таблицу администраторов**. Мы обновим файл AdminsTableSeeder, чтобы вставить нескольких субадминистраторов в базу данных.
- **Отображение субадминистраторов на панели администратора**. Мы отобразим субадминистраторов на панели администратора.
## Шаг 1. Добавление субадминистраторов в таблицу администраторов
Мы обновим файл ```AdminsTableSeeder.php```, чтобы вставить в базу данных нескольких субадминистраторов, и закомментируем существующий запрос администратора.

**Обновить AdminsTableSeeder.php**
```php
public function run(): void
{
    $password = Hash::make('123456');
    $admin = new Admin;
    /*$admin->name = 'Oleg Deryabin';
    $admin->role = 'admin';
    $admin->mobile = '79061291066';
    $admin->email = 'admin@mail.ru';
    $admin->password = $password;
    $admin->status = 1;
    $admin->save();*/
    $admin = new Admin;
    $admin->name = 'Oleksha';
    $admin->role = 'subadmin';
    $admin->mobile = '97000000000';
    $admin->email = 'oleksha@mail.ru';
    $admin->password = $password;
    $admin->status = 1;
    $admin->save();

    $admin = new Admin;
    $admin->name = 'John Doe';
    $admin->role = 'subadmin';
    $admin->mobile = '96000000000';
    $admin->email = 'john@mail.ru';
    $admin->password = $password;
    $admin->status = 1;
    $admin->save();
}
```
## Шаг 2. Обновление класса Seeder
Обновите DatabaseSeeder.php, чтобы вызвать класс AdminsTableSeeder и заполнить базу данных.

**Обновить DatabaseSeeder.php**
```php
$this->call(AdminsTableSeeder::class);
```
**Запустить команду сеялки**

Используйте следующую команду для добавления новых записей субадминистраторов в таблицу администраторов:
```
php artisan db:seed --class-AdminsTableSeeder
```
## Шаг 3. Отображение субадминистраторов на панели администратора
Мы обновим боковую панель, создадим маршруты и отобразим субадминистраторов на панели администратора, выполнив следующие шаги:

**Обновить sidebar.blade.php**

Добавьте модуль субадминистрирования на боковую панель администратора (виден только администраторам):
```html
@if(Auth::guard('admin')->user()->role == 'admin')
    <!-- Admins / Sub Admins -->
    <li class="nav-item">
        <a href="{{ url('admin/subadmins') }}" class="nav-link {{ (Session::get('page') == 'subadmins') ? 'active' : '' }}">
            <i class="nav-icon bi bi-circle"></i>
            <p>Subadmins</p>
        </a>
    </li>
@endif
```
## Шаг 4. Создайте маршрут
Создайте маршрут ```GET``` для отображения субадминистраторов:

**Обновить web.php**
```php
// Sub-Admins
Route::get('subadmins', [AdminController::class, 'subadmins']);
```
## Шаг 5. Создайте функцию subadmins в AdminService
Напишите запрос для выбора всех субадминистраторов из таблицы администраторов и возврата их контроллеру.
```php
public function subadmins(): Collection
{
    return Admin::where('role', 'subadmin')->get();
}
```
## Шаг 6. Создайте функцию субадминистраторов в AdminController
Вызовите функцию ```subadmins``` из ```AdminService``` и передайте данные в представление.

**AdminController.php**
```php
public function subadmins()
{
    Session::put('page', 'subadmins');
    $subadmins = $this->adminService->subadmins();
    return view('admin.subadmins.subadmins', compact('subadmins'));
}
```
## Шаг 7. Создайте subadmins.blade.php
Создайте файл ```subadmins.blade.php```, выполнив следующие действия:
1. Создайте папку ```subadmins``` в папке ```\resources\views\admin\```.
2. Создайте файл ```subadmins.blade.php``` внутри папки ```subadmins```.
3. Добавьте содержимое из файла ```simple.html``` шаблона AdminLTE, расположенного в папке ```/dist/pages/tables/simple.html```.
4. Используйте цикл ```foreach``` для отображения списка субадминистраторов, включая их идентификатор, имя, мобильный телефон, электронную почту и действия.

**subadmins.blade.php**
```html
@extends('admin.layout.layout')
@section('content')
    <main class="app-main">
        <!--begin::App Content Header-->
        <div class="app-content-header">
            <!--begin::Container-->
            <div class="container-fluid">
                <!--begin::Row-->
                <div class="row">
                    <div class="col-sm-6"><h3 class="mb-0">Управление администратором</h3></div>
                    <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-end">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Subadmins</li>
                        </ol>
                    </div>
                </div>
                <!--end::Row-->
            </div>
            <!--end::Container-->
        </div>
        <!--end::App Content Header-->
        <!--begin::App Content-->
        <div class="app-content">
            <!--begin::Container-->
            <div class="container-fluid">
                <!--begin::Row-->
                <div class="row">
                    <div class="col-md-12">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3 class="card-title">Subadmins</h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                                <table id="subadmins" class="table table-bordered table-striped">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Mobile</th>
                                        <th>Email</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    @foreach($subadmins as $subadmin)
                                        <tr>
                                            <td>{{ $subadmin->id }}</td>
                                            <td>{{ $subadmin->name }}</td>
                                            <td>{{ $subadmin->mobile }}</td>
                                            <td>{{ $subadmin->email }}</td>
                                            <td></td>
                                        </tr>
                                    @endforeach
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!--end::Row-->
            </div>
            <!--end::Container-->
        </div>
        <!--end::App Content-->
    </main>
@endsection
```
# Что дальше?
В [следующей части](16.md) мы реализуем функции «Активный/Неактивный статус» и «Удаление» для субадминистраторов.

[Оглавление](../README.md)
