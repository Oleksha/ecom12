# Часть 56. Управление баннерами на главной странице (IV) | Динамическое отображение баннеров на главной странице
В этой части мы динамически отображаем слайдер домашней страницы и фиксированные баннеры, используя данные из таблицы баннеров, управляемой из панели администратора.

Мы также проведем рефакторинг кода, введя IndexService, чтобы сохранить чистоту логики контроллера.

Что мы будем делать в этой части:
1. Создайте класс Front/IndexService для извлечения слайдера и фиксированных баннеров.
2. Обновите IndexController для использования новой службы.
3. Обновите Blade-файл front.index для динамического отображения слайдера и фиксированных баннеров.
## Шаг 1: Создание IndexService
Создайте новый сервис для загрузки динамических баннеров:

Создайте папку **Front** по адресу **path/app/Services/**

Создайте файл **IndexService.php** по адресу **path/app/Services/Front/**

Чтобы сохранить контроллер чистым и следовать архитектуре, основанной на сервисах, мы создадим этот **IndexService**
```php
namespace App\Services\Front;

use App\Models\Banner;

class IndexService
{
    public function getHomePageBanners()
    {
        $homeSliderBanners = Banner::where('type', 'Slider')
            ->where('status', 1)
            ->orderBy('sort', 'desc')
            ->get()->toArray();
            
        $homeFixBanners = Banner::where('type', 'Fix')
            ->where('status', 1)
            ->orderBy('sort', 'desc')
            ->get()->toArray();
        
        return compact('homeSliderBanners', 'homeFixBanners');
    }
}
```
## Шаг 2. Обновите IndexController.
Мы обновляем функцию index() для извлечения баннеров из таблицы баннеров:
```php
namespace App\Http\Controllers\Front;

use App\Http\Controllers\Controller;
use App\Services\Front\IndexService;

class IndexController extends Controller
{
    public function __construct(
        protected IndexService $indexService
    )
    {}

    public function index()
    {
        $banners = $this->indexService->getHomePageBanners();
        return view('front.index')->with($banners);
    }
}
```
## Шаг 3: Обновление front/index.blade.php
Обновите раздел «Слайдер-баннер»:

Заменить статические изображения в разделе слайдера (#header-carousel):
```html
<div id="header-carousel" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
        @foreach($homeSliderBanners as $key => $sliderBanner)
            <div class="carousel-item @if($key == 0) active @endif" style="height: 610px;">
                <a href="{{ $sliderBanner['link'] }}" title="{{ $sliderBanner['title'] }}">
                    <img class="img-fluid"
                         src="{{ asset('front/images/banners/' . $sliderBanner['image']) }}"
                         alt="{{ $sliderBanner['alt'] }}" title="{{ $sliderBanner['title'] }}">
                </a>
            </div>
        @endforeach
    </div>
    @if(count($homeSliderBanners) > 1)
        <a class="carousel-control-prev" href="#header-carousel" data-slide="prev">
            <div class="btn btn-dark" style="width: 45px; height: 45px;">
                <span class="carousel-control-prev-icon mb-n2"></span>
            </div>
        </a>
        <a class="carousel-control-next" href="#header-carousel" data-slide="next">
            <div class="btn btn-dark" style="width: 45px; height: 45px;">
                <span class="carousel-control-next-icon mb-n2"></span>
            </div>
        </a>
    @endif
</div>
```
**Обновите раздел «фиксированных баннеров»:**

Заменить статические фиксированные баннерные блоки:
```html
<div class="container-fluid offer pt-2">
    <div class="row px-xl-5">
        @foreach($homeFixBanners as $fixBanners)
            <div class="col-md-6 pb-4">
                <div class="position-relative bg-secondary text-center text-md-right text-white mb-2 py-5 px-5"
                     style="background-image: url('{{ asset('front/images/banners/' . $fixBanners['image']) }}'); background-size: cover;">
                    <div class="position-relative" style="z-index: 1;">
                        <h5 class="text-uppercase text-primary mb-3">{{ $fixBanners['alt'] }}</h5>
                        <h1 class="mb-4 font-weight-semi-bold">{{ $fixBanners['title'] }}</h1>
                        <a href="{{ $fixBanners['link'] }}" class="btn btn-outline-primary py-md-2 px-md-3">Shop Now</a>
                    </div>
                </div>
            </div>
        @endforeach
    </div>
</div>
```
## Шаг 4: Настройте размеры изображения
Если размер вашего баннера (например, 1366x800) обрезается снизу, удалите фиксированную высоту (высота: 610 пикселей) или соответствующим образом настройте свойства background-size и object-fit в CSS.
# Что дальше?
В [следующей части](57.md) мы продолжим работать над домашней страницей.

[Оглавление](../README.md)
