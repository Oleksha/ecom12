# Часть 49. Модуль брендов (V): показывать поле выбора брендов в форме добавления/редактирования продукта
В этой части мы продолжим разработку функции динамического бренда в панели администратора. Мы позволим администраторам назначать бренд каждому продукту с помощью раскрывающегося списка в форме «Добавить/редактировать продукт».
## Шаг 1. Обновите функцию create() в ProductController:
Извлечь все активные бренды и передать их в представление добавления/редактирования.
```php
public function create()
{
    $title = "Добавить продукт";
    $getCategories = Category::getCategories('Admin');
    // Получить все активные бренды
    $brands = Brand::where('status', 1)->get()->toArray();
    return view('admin.products.add_edit_product', compact('title', 'getCategories', 'brands'));
}
```
## Шаг 2. Обновите функцию edit() в ProductController:
Загружайте все активные бренды при редактировании существующего продукта.
```php
public function edit(string $id)
{
    $title = "Изменение продукта";
    $product = Product::with(['product_images', 'attributes'])->findOrFail($id);
    $getCategories = Category::getCategories('Admin');
    // Получить все активные бренды
    $brands = Brand::where('status', 1)->get()->toArray();
    return view('admin.products.add_edit_product', compact('title', 'product', 'getCategories', 'brands'));
}
```
## Шаг 3. Обновите add_edit_product.blade.php:
Добавьте поле выбора бренда сразу под выбором категории.
```html
<div class="mb-3">
    <label class="form-label" for="brand_id">Бренд*</label>
    <select name="brand_id" id="brand_id" class="form-select">
        <option value="">Выберите</option>
        @foreach($brands as $brand)
            <option value="{{ $brand['id'] }}" {{ old('brand_id', $product->brand_id ?? '') == $brand['id'] ? 'selected' : '' }}>
                {{ $brand['name'] }}
            </option>
        @endforeach
    </select>
</div>
```
## Шаг 4. Обновите addEditProduct() в ProductService:
Присвойте выбранную марку продукту.
```php
$product->brand_id = $data['brand_id'];
```
## Шаг 5. Обновите ProductRequest для проверки:
Убедитесь, что выбор бренда является обязательным при добавлении/редактировании.
```php
return [
    'category_id' => 'required',
    'brand_id' => 'required',
    'product_name' => 'required|max:200',
    'product_code' => 'required|max:30',
    'product_price' => 'required|numeric|gt:0',
    'product_color' => 'required|max:200',
    'family_color' => 'required|max:200',
];
```
Добавьте пользовательские сообщения об ошибках:
```php
return [
    'category_id.required' => 'Обязательно укажите название категории.',
    'brand_id.required' => 'Обязательно укажите название бренда.',
    'product_name.required' => 'Обязательно укажите название продукта.',
    'product_code.required' => 'Обязательно укажите код продукта.',
    'product_price.required' => 'Обязательно укажите цену продукта.',
    'product_price.numeric' => 'Цена продукта должна быть корректной.',
    'product_color.required' => 'Обязательно укажите цвет продукта.',
    'family_color.required' => 'Обязательно укажите семейство цветов продукта.',
];
```
Вот и всё! Теперь вы можете назначить бренд каждому продукту через форму и легко управлять ими из панели управления.
# Что дальше?
В [следующей части](50.md) мы обновим панель управления, добавим сидер для добавления продуктов, а также внесем последние штрихи в панель администратора перед началом работы над внешним интерфейсом.

[Оглавление](../README.md)
